cd /c/Users/srika/devsecops/shellscript/Notes/Terraform_notes/

VPC with CIDR
IGW and attach to VPC
Subnets with CIDR
Route tables
Route tables association with subnets
Routes
EIP
NAT
Add NAT route to private subnets

--> AWS-VPC folder created->name manaistum so vpc.tf ani rasa
in this folder we need to create VPC resources EX more : https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc
see in VSCODE

--> VPC-module folder-->name mana istum main.tf rasa-->provoder.tf and gitigonore file copied..
--> 
project_name-environment-<resource_name> --> idhi manam pettukuntunna condistion or rule vere company ki velte valla rules manam chudali.... 
--> so now we need to create varialbels for project name and environ see in variable.tf file
-->local.tf create chestam bcz no can override, so here every project ki use chestam ----------see in VSCODE

--> AWS-VPC folder vunna variables and VPC-module test lo vunna variables both are not same.. both are different
--> inputs must give module so they have to create output.tf in module folder
 aws_vpc.main.id ---> vpc.tf folder lo aws_vpc "main" block run avvalante aws.vpc.main.id iste oka id ani iste manaki vpc id vstudhi
---> so upto here VPC resourse create chesam and vpc id ni tisukunnam
---> IGW for EX more https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/internet_gateway.html
--> igw has bee done in vpc.tf lo 
--> next subnets creation, here we have to create min 2 subnets for high availability kosam..
https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet

--> module test lo default= ["10.0.1.0/24","10.0.2.0/24" ivi user side numchi vasati vatini vpc.tf lo represent cheyali count loop chesi
var.public_subnet_cidrs[count.index] here one by one loop avuthai ip lu 

--> avaiabilty zolu ivvakapothe ekkadao create chestundhi so ala vadhu  https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/availability_zones
data.tf lo slice function chudali

map_public_ip_on_launch = true --> here manam cheptunam ee subnet lo vache vatiki pub ip ni assign chei ani so akkada false vunte vadhu ani 

public_subnet_cidrs = var.public_subnet_cidrs --> {so here user must be providing values are public subnet cidrs
  # dhani kosam module lo test lo kuda define cheyali like varialble.tf lo and
  # main.tf lo declare cheyali } 
upto here pub subnet are created so next by using same module i want crated like as below

public ki subnet 		private ki subnet	database also here
frontend	                backend		       data related

so insted of public we need to replace with private names
--> for pvt ki user emi ip lu pass cheyalo vi pass cheyali in main.tf lo 

so alane same for database ki kuda
upto here vpc done, 
igw done attached to vpc
subnets done for pub,pvt and db

---> route tables created in vpc.tf and variables.tf lo for pub and pvt and db ki 
-->Route needs to create https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route..... syntax
--> pub route created and it has been attached to pub route table path route table--> pub rt--> routes in below dashboard

-->  needs to create nat gateway for pvt and db, so for that we have to create elastic ip first
-->eip done in vpc.tf and variable.tf 
--> nat gateway has been done in vpc.tf and 
aws_subnet.public[0.id] so here aws_subnet_public lo two vunnai az lu like us-1a an us1b so andhulo naaku first dhi kavali ni aduguthunam

Basically terraform automatic ga dependency ni resolve chesukunttadhi 
depends_on = [aws_internet_gateway.main] --> it means nat anedhi ig meedha depend avuthundi bcz andhulo numchi he kadha traffic batatiki velledhi -> sess-36-1:00:00

########################
VPC peering
============
2 villages or cities communicate avvatum 

if we want communication between multiple VPC, we need peering. By default one vpc can't communicate with another VPC
--->A VPC peering connection helps you to facilitate the transfer of data. 

1. VPC's should not have same CIDR
2. routes also should be available

What are the VPC should connect?
=============================
same region VPC's could be connect
diff region VPC could be connect
diff account diff region VPC's could be connect

-->oka accout lo vunna VPC ni another account vunna VPC ni connect avvachu 

--> mainly a company while working with thrird party company so then for data sharing activity is done through this peering function
--> peering lo opposite side vallu kuda accept chestene aa peering function work ayyedhi.. once oka side peering connection create chesaka opposite vallaki cheppali please accept my peering connection ani
--> for accept steps are --> go to action --> click on accept --> this is done by same region lo 
--> region lo ithe vallali chepali accept chei ani

Village-1 numchi Village-2 ki vellali ante manki road avasarum 

source = village-1
destination = Village-2

--> so road kosam--> routes lo pub rt ni open chesi edit rt lo another side valla CIDR ivvali ( destination) --> dhenitho velutunnam peering connection select cheyali


172.31.0.0/16 idhi opposite valla CIDR range 

172.31.1.221 -ila vunte ne request veluthundi.. so this whin range for that

173.45.25.36 --- idhi out of range

emi lekapothe by default ip like 0.0.0.0 ni tisukuntadhi...........

--> so village-1 velli village-2 ni connect avvali anukunte dhani routes lo village 2 destination (CIDR) ivvali and peering ni select cheesukovai 
vilage-2 kuda village-1 ni connect avvali so village-2 rotes lo destination icchi (CIDR) ivvali village-1 dhi

--> Module develop chese vallu doc definitely provide chestaru....
